#!/usr/bin/env bash

. "${HARNESS_HOME}/bin/harness-env"

ENGINE_ID=$1

if [ -z "$ENGINE_ID" ]; then
    echo -e "${CYAN}Getting Harness Server status${NC}"
    echo -e "${GLINE}"
    echo "HARNESS_HOME........${HARNESS_HOME}"
    echo "REST_SERVER_HOST....${REST_SERVER_HOST}"
    echo "REST_SERVER_PORT....${REST_SERVER_PORT}"
    echo "MONGO_HOST..........${MONGO_HOST}"
    echo "MONGO_PORT..........${MONGO_PORT}"
    echo "HARNESS_LOG_CONFIG..${HARNESS_LOG_CONFIG}"
    echo "HARNESS_LOG_PATH....${HARNESS_LOG_PATH}"
    echo -e "${RLINE}"
    ${HARNESS_HOME}/bin/command.py status
    exit 1
fi

if [ ${ENGINE_ID} = "engines" ]; then
    echo -e "${CYAN}Getting status for all Engines:${NC}"
    PYTHON_ARGS="status --all-engines"

    echo -e "${CYAN}Run ${HARNESS_HOME}/bin/engine.py ${PYTHON_ARGS}${NC}"

    ${HARNESS_HOME}/bin/engine.py ${PYTHON_ARGS}
    exit $?
fi

if [ ! -z ${ENGINE_ID} ]; then
    echo -e "${CYAN}Getting status for engine-id: ${ENGINE_ID}${NC}"
    PYTHON_ARGS="status ${ENGINE_ID}"

    echo -e "${CYAN}Run ${HARNESS_HOME}/bin/engine.py ${PYTHON_ARGS}${NC}"

    ${HARNESS_HOME}/bin/engine.py ${PYTHON_ARGS}
    exit $?
fi

echo -e "   ${RED}Error in command, should be: harness status [[ -a | <engine-id>]]${NC}"
echo -e "       Prints a status message for the harness server, all engines or for the engine specified."
echo ""



