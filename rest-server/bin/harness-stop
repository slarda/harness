#!/usr/bin/env bash

. "${HARNESS_HOME}/bin/harness-env"

# Harness Server
echo -e "${GREEN}Stopping Harness Server.${NC}"

export PIDFILE=${HARNESS_HOME}/harness.pid

if [ -e ${PIDFILE} ]; then
    cat ${PIDFILE} | xargs kill
    if [[ $? != 0 ]]; then # this is not sufficient, the command is async so the stop will return but the pid may be active
        echo -e "${RED}Unable to stop Harness from PID file. May already be stopped.${NC}"
        echo -e "${RED}Removing PID file.${NC}"
    fi
    rm ${PIDFILE}
else
    echo -e "${RED}PID file not found.${NC}"
fi
